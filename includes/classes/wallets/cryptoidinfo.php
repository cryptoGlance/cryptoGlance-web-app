<?php
/*
 * @author Blonďák
 */
class Wallets_CryptoidInfo extends Wallets_Abstract implements IWallet {
	
	public static function getSupportedWallets(){
		return array(
			'1CR',
			'2FLAV',
			'2GIVE',
			'808',
			'AC',
			'ARC',
			'ARCH',
			'ARG',
			'ATX',
			'B3',
			'BAY',
			'BCR',
			'BEE2',
			'BITB',
			'BLITZ',
			'BLK',
			'BLOCK',
			'BLZ',
			'BOLI',
			'BSD',
			'BSTY',
			'BTA',
			'BVC',
			'BXT',
			'BYC',
			'CANN',
			'CARBON',
			'CBX',
			'CCN',
			'CENT',
			'CLUB',
			'CNO',
			'CPAY',
			'CPC',
			'CRYPT',
			'CRW',
			'CSH',
			'CURE',
			'DASH',
			'DBG',
			'DGC',
			'DIME',
			'DMD',
			'DOT',
			'DP',
			'DRZ',
			'EC',
			'EFL',
			'ENRG',
			'ENT',
			'ERC',
			'ETHS',
			'FAIL',
			'FIRE',
			'FLT',
			'FSX',
			'FUEL',
			'FUNK',
			'GAM',
			'GAP',
			'GBT',
			'GCR',
			'GLC',
			'GLD',
			'GOLF',
			'GRE',
			'GRN',
			'GRS',
			'GRT',
			'GUN',
			'HIRE',
			'HYPER',
			'I0C',
			'ICN',
			'INFX',
			'IOC',
			'ION',
			'IXC',
			'J',
			'JBS',
			'JWL',
			'KARM',
			'LANA',
			'LEA',
			'LIR',
			'LTC',
			'LXC',
			'MND',
			'MOJO',
			'MOON',
			'MPC',
			'MST',
			'MTR',
			'MUE',
			'NAV',
			'NCL',
			'NEOS',
			'NEVA',
			'NOBL',
			'NXC',
			'OCTO',
			'OK',
			'OMC',
			'OP',
			'OPAL',
			'PEX',
			'PIGGY',
			'PINK',
			'PKB',
			'PND',
			'POT',
			'PPC',
			'PR',
			'PSB',
			'PX',
			'RADS',
			'RADS-TEST',
			'RBY',
			'RIC',
			'RUB',
			'SAR',
			'SCRT',
			'SDC',
			'SHA',
			'SILK2',
			'SLR',
			'SMBR',
			'SNRG',
			'SPR',
			'STK',
			'STRAT',
			'STV',
			'SWIFT',
			'SWING',
			'SYS',
			'TAJ',
			'TALK',
			'TECH',
			'TES',
			'TIPS',
			'TROLL',
			'TRUST',
			'TUBE',
			'TX',
			'UNIQ',
			'UNO',
			'URO',
			'VCN',
			'VIA',
			'VIRAL',
			'VRC',
			'VRM',
			'VTA',
			'WARP',
			'WBB',
			'WEX',
			'XAU',
			'XBTC21',
			'XBV',
			'XC',
			'XDE',
			'XJC',
			'XJM',
			'XJO',
			'XMG',
			'XP',
			'XPO',
			'XPY',
			'XST',
			'XXX',
			'ZEIT',
			'ZET',
		);
	}

    public function __construct($label, $address, $currency) {
        parent::__construct($label, $address);
    	$this->currency = $currency;
        $this->_apiURL = 'http://chainz.cryptoid.info/'.strtolower($currency).'/api.dws?q=getbalance&key=6e1508c63640&a=' . $address;
        $this->_fileHandler = new FileHandler('wallets/'.$currency.'/' . $this->_address . '.json');
    }

    public function update() {
        if ($GLOBALS['cached'] == false || $this->_fileHandler->lastTimeModified() >= 3600) { // updates every 60 minutes.
            $addressBalance = curlCall($this->_apiURL);

            $data = array (
                'label' => $this->_label,
                'address' => $this->_address,
                'balance' => (float) $addressBalance
            );

            $this->_fileHandler->write(json_encode($data));
            return $data;
        }

        return json_decode($this->_fileHandler->read(), true);
    }

}
